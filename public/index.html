<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#f9fafb" />
		<title>WalletWise Journal</title>

		<link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
		<link
			rel="icon"
			type="image/png"
			href="favicon/favicon-96x96.png"
			sizes="96x96"
		/>
		<link rel="shortcut icon" href="favicon/favicon.ico" />
		<link
			rel="apple-touch-icon"
			sizes="180x180"
			href="favicon/apple-touch-icon.png"
		/>
		<link rel="manifest" href="favicon/site.webmanifest" />
		<meta name="apple-mobile-web-app-title" content="WalletWise" />

		<noscript>
			<link
				rel="stylesheet"
				href="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.11.6/viewer.min.css"
			/>
			<link
				rel="stylesheet"
				href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
			/>
		</noscript>

		<style>
			body {
				visibility: hidden;
				opacity: 0;
				transition: opacity 0.3s ease-in-out; /* ふわっと表示させる */
			}
		</style>
	</head>
	<body class="bg-neutral-50 text-neutral-800">
		<noscript>
			<style>
				/* JS無効時はbodyを表示するが、アプリのコンテンツは隠す */
				body {
					visibility: visible !important;
					opacity: 1 !important;
				}
				/* アプリのメインコンテンツを隠す */
				#app-container,
				#menu-panel,
				#menu-overlay,
				#notification-banner,
				#transaction-modal,
				#guide-modal,
				#settings-modal,
				#icon-picker-modal,
				#scan-start-modal,
				#scan-confirm-modal,
				#report-modal {
					display: none !important;
				}
				/* noscriptの内容を見やすく表示 */
				.noscript-content {
					position: fixed;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
					display: flex;
					flex-direction: column;
					align-items: center;
					justify-content: center;
					background-color: #f9fafb;
					z-index: 9999;
					padding: 24px;
					text-align: center;
					font-family: system-ui, -apple-system, sans-serif;
					box-sizing: border-box;
				}
				.noscript-icon {
					font-size: 3rem;
					color: #dc2626;
					margin-bottom: 1.5rem;
				}
				.noscript-title {
					font-size: 1.5rem;
					font-weight: bold;
					color: #1f2937;
					margin-bottom: 1rem;
					line-height: 1.3;
				}
				.noscript-text {
					color: #4b5563;
					line-height: 1.6;
					max-width: 500px;
					margin: 0 auto;
					font-size: 1rem;
				}
				/* スマホ向けの調整 */
				@media (max-width: 640px) {
					.noscript-icon {
						font-size: 2.5rem;
						margin-bottom: 1rem;
					}
					.noscript-title {
						font-size: 1.25rem;
					}
					.noscript-text {
						font-size: 0.875rem;
					}
				}
			</style>
			<div class="noscript-content">
				<i class="fas fa-exclamation-triangle noscript-icon"></i>
				<h2 class="noscript-title">JavaScriptが必要です</h2>
				<p class="noscript-text">
					WalletWise
					Journalを利用するには、ブラウザの設定でJavaScriptを有効にしてください。
				</p>
			</div>
		</noscript>

		<div id="notification-banner-root"></div>

		<div id="app-container" class="max-w-4xl mx-auto px-4 md:px-6 pb-4 md:pb-6">
			<header
				class="sticky top-0 z-30 flex items-center justify-between bg-neutral-50 py-2 border-b border-neutral-200 mb-6 h-16 transform-gpu"
			>
				<div id="side-menu-container"></div>

				<div
					class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center gap-2 w-full max-w-[calc(100%-100px)] md:static md:w-auto md:max-w-none md:justify-start md:grow md:ml-3 md:translate-x-0 md:translate-y-0"
				>
					<img
						src="favicon/favicon-96x96.png"
						alt="Logo"
						class="w-8 h-8 shrink-0 rounded-lg"
						width="32"
						height="32"
					/>
					<h1
						class="text-xl md:text-2xl font-bold tracking-tight truncate text-center md:text-left"
					>
						<span
							class="bg-clip-text text-transparent bg-linear-to-r from-primary to-violet-600"
							>WalletWise</span
						>
						<span class="text-neutral-800">Journal</span>
					</h1>
				</div>

				<div class="flex items-center gap-3 shrink-0 z-20 ml-auto md:ml-0">
					<div class="hidden md:block">
						<p
							id="last-updated-time"
							hidden
							class="text-xs text-neutral-400 whitespace-nowrap"
						>
							データ取得中...
						</p>
					</div>

					<button
						id="refresh-data-button"
						aria-label="データを更新する"
						hidden
						class="w-10 h-10 flex items-center justify-center rounded-full text-primary bg-white shadow-sm hover:bg-primary-light transition-all active:scale-95"
						title="データを更新"
					>
						<i id="refresh-icon" class="fas fa-sync-alt text-lg"></i>
					</button>
				</div>
			</header>

			<div id="auth-screen" class="text-center py-20">
				<div id="auth-container">
					<div id="loading-indicator">
						<i class="fas fa-spinner fa-spin text-4xl text-primary"></i>
						<p class="mt-4 text-lg">認証情報を確認しています...</p>
					</div>
					<div id="update-indicator" hidden>
						<i class="fas fa-sync-alt fa-spin text-4xl text-primary"></i>
						<p class="mt-4 text-lg">アプリを更新しています...</p>
					</div>
					<div id="login-container" hidden>
						<h2 class="text-2xl font-bold mb-4">おかえりなさい</h2>
						<p class="text-neutral-800 mb-8">
							データを表示するにはログインしてください。
						</p>
						<button
							id="login-button"
							class="bg-white text-neutral-800 font-semibold py-3 px-6 rounded-lg shadow-md border border-neutral-200 hover:bg-neutral-100 transition inline-flex items-center"
						>
							<img
								src="https://www.google.com/favicon.ico"
								alt="Google"
								class="w-6 h-6 mr-3"
							/>
							Googleアカウントでログイン
						</button>
					</div>
					<p class="text-xs text-neutral-400 mt-8">
						This site is protected by reCAPTCHA and the Google
						<a
							href="https://policies.google.com/privacy"
							target="_blank"
							class="underline hover:text-neutral-600"
							>Privacy Policy</a
						>
						and
						<a
							href="https://policies.google.com/terms"
							target="_blank"
							class="underline hover:text-neutral-600"
							>Terms of Service</a
						>
						apply.
					</p>
				</div>
			</div>

			<main id="main-content" hidden>
				<section id="home-section" class="mb-8">
					<h2
						class="text-lg md:text-xl font-bold text-neutral-900 border-l-4 border-primary pl-3 mb-4"
					>
						資産一覧
					</h2>

					<div id="dashboard-total-assets" class="mb-6"></div>

					<div id="ai-advisor-card-container"></div>

					<div
						id="balances-grid"
						class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"
					></div>
				</section>

				<section id="assets-history-section" class="mb-8 scroll-mt-20">
					<h2
						class="text-lg md:text-xl font-bold text-neutral-900 border-l-4 border-primary pl-3 mb-4"
					>
						資産推移
					</h2>
					<div class="bg-white p-4 md:p-6 rounded-xl shadow-sm">
						<div class="scroll-hint-wrapper w-full">
							<div
								class="overflow-x-auto md:overflow-x-visible no-scrollbar flex"
								id="history-chart-scroll-container"
							>
								<div id="history-chart-container" class="w-full"></div>
							</div>
						</div>
						<p
							id="history-chart-placeholder"
							hidden
							class="text-neutral-500 text-center py-10"
						>
							取引データがありません
						</p>
					</div>
				</section>

				<section id="analysis-section" class="mb-8 scroll-mt-20">
					<div id="analysis-report-root"></div>
				</section>

				<section id="billing-section" class="mb-6">
					<h2
						class="text-lg md:text-xl font-bold mb-4 text-neutral-900 border-l-4 border-primary pl-3"
					>
						次回のカード支払い予定
					</h2>
					<div id="billing-list" class="space-y-4"></div>
				</section>

				<section id="transactions-section"></section>
			</main>
		</div>

		<div id="transaction-modal-root"></div>
		<div id="scan-modal-root"></div>
		<div id="guide-modal-root"></div>
		<div id="settings-root"></div>
		<div id="terms-modal-root"></div>
		<div id="report-modal-root"></div>

		<script type="module" src="src/main.jsx"></script>
	</body>
</html>
